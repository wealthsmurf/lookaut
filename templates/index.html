<!DOCTYPE html>
<html lang="ko">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title>ë¸”ë¡ ë°©ì–´</title>
Â  Â  <style>
Â  Â  Â  Â  body {Â 
Â  Â  Â  Â  Â  Â  margin: 0; overflow: hidden; background: #f4f4f4;Â 
Â  Â  Â  Â  Â  Â  display: flex; justify-content: center; align-items: center;Â 
Â  Â  Â  Â  Â  Â  height: 100vh; font-family: 'Malgun Gothic', sans-serif;
Â  Â  Â  Â  Â  Â  touch-action: manipulation;
Â  Â  Â  Â  }
Â  Â  Â  Â  #game-wrapper {Â 
Â  Â  Â  Â  Â  Â  position: relative;Â 
Â  Â  Â  Â  Â  Â  width: 100%;Â 
Â  Â  Â  Â  Â  Â  max-width: 400px;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  canvas {Â 
Â  Â  Â  Â  Â  Â  background: #ffffff; border: 3px solid #333;Â 
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 20px rgba(0,0,0,0.2);
Â  Â  Â  Â  Â  Â  width: 80vw;Â 
Â  Â  Â  Â  Â  Â  max-width: 360px;
Â  Â  Â  Â  Â  Â  height: auto;Â 
Â  Â  Â  Â  Â  Â  max-height: 70vh;
Â  Â  Â  Â  }
Â  Â  Â  Â  .panel {
Â  Â  Â  Â  Â  Â  display: none; position: absolute; top: 50%; left: 50%;Â 
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%); background: white;Â 
Â  Â  Â  Â  Â  Â  padding: 20px; border-radius: 15px; border: 3px solid #333;Â 
Â  Â  Â  Â  Â  Â  text-align: center; z-index: 100; box-shadow: 0 0 40px rgba(0,0,0,0.5);Â 
Â  Â  Â  Â  Â  Â  width: 75%; max-width: 280px;
Â  Â  Â  Â  }
Â  Â  Â  Â  button {Â 
Â  Â  Â  Â  Â  Â  padding: 12px 24px; background: #333;Â 
Â  Â  Â  Â  Â  Â  color: white; border: none; border-radius: 8px;Â 
Â  Â  Â  Â  Â  Â  cursor: pointer; font-weight: bold; font-size: 15px;
Â  Â  Â  Â  Â  Â  transition: transform 0.1s;
Â  Â  Â  Â  }
Â  Â  Â  Â  button:active { transform: scale(0.95); }
Â  Â  Â  Â  #ui-panel {
Â  Â  Â  Â  Â  Â  position: absolute; top: 15px;Â 
Â  Â  Â  Â  Â  Â  width: 85vw;Â 
Â  Â  Â  Â  Â  Â  max-width: 360px;
Â  Â  Â  Â  Â  Â  display: flex; justify-content: space-between; align-items: center;
Â  Â  Â  Â  Â  Â  pointer-events: none; z-index: 10;
Â  Â  Â  Â  }
Â  Â  Â  Â  .info-box {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.9); padding: 4px 10px;Â 
Â  Â  Â  Â  Â  Â  border-radius: 6px; border: 2px solid #333; font-weight: bold; font-size: 12px;
Â  Â  Â  Â  Â  Â  pointer-events: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â  .tip-box { font-size: 10px; color: #666; text-align: center; line-height: 1.2; font-weight: bold; }
Â  Â  Â  Â  .right-ui-group { display: flex; align-items: center; gap: 5px; }
Â  Â  Â  Â  #mute-btn {
Â  Â  Â  Â  Â  Â  background: #444; color: white; border: 2px solid #333;
Â  Â  Â  Â  Â  Â  padding: 4px 8px; border-radius: 6px; font-size: 10px;
Â  Â  Â  Â  Â  Â  cursor: pointer; pointer-events: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â  .bottom-nav {
Â  Â  Â  Â  Â  Â  width: 100%; height: 60px; background: white;
Â  Â  Â  Â  Â  Â  position: fixed; bottom: 0; display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center; align-items: center;
Â  Â  Â  Â  Â  Â  border-top: 1px solid #ddd; z-index: 1000;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* ê´‘ê³  ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
Â  Â  Â  Â  .ad-loader { font-size: 12px; color: #999; position: absolute; }
Â  Â  </style>
</head>
<body>
Â  Â  <div id="game-wrapper">
Â  Â  Â  Â  <div id="ui-panel">
Â  Â  Â  Â  Â  Â  <div id="time-display" class="info-box">0.0s</div>
Â  Â  Â  Â  Â  Â  <div class="tip-box">í•˜ì–€ ë¸”ë¡(ì  4ê°œ)ë§Œ<br>ì§€í‚¤ì„¸ìš”!</div>
Â  Â  Â  Â  Â  Â  <div class="right-ui-group">
Â  Â  Â  Â  Â  Â  Â  Â  <div id="best-display" class="info-box" style="color: #007bff;">Best: 0.0s</div>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="mute-btn" onclick="toggleMute(event)">ğŸµ On</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <canvas id="gameCanvas"></canvas>

Â  Â  Â  Â  <div class="bottom-nav">Â 
Â  Â  Â  Â  Â  Â  <ins class="kakao_ad_area" style="display:none;"
Â  Â  Â  Â  Â  Â  Â  Â  data-ad-unit = "DAN-8OJpo4T0Kc2rPuXZ"
Â  Â  Â  Â  Â  Â  Â  Â  data-ad-width = "320"
Â  Â  Â  Â  Â  Â  Â  Â  data-ad-height = "50"></ins>
Â  Â  Â  Â  Â  Â  <script type="text/javascript" src="//t1.daumcdn.net/kas/static/ba.min.js" async></script>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="start-overlay" class="panel" style="display: flex; flex-direction: column;">
Â  Â  Â  Â  Â  Â  <h2 style="margin-top:0;">ğŸ›¡ï¸ ë¸”ë¡ ë°©ì–´</h2>
Â  Â  Â  Â  Â  Â  <p style="font-size: 13px; color: #444; line-height: 1.5;">
Â  Â  Â  Â  Â  Â  Â  Â  1. <b>í•˜ì–€ ì ë°•ì´</b> ë¸”ë¡ì„ í´ë¦­í•´ íŒŒê´´í•˜ì„¸ìš”!<br>

Â  Â  Â  Â  Â  Â  Â  Â  2. ì  í•˜ë‚˜ ë¸”ë¡ì€ ê·¸ëƒ¥ ê´‘ê³ ê°€ ë‚˜ì˜µë‹ˆë‹¤!<br>

Â  Â  Â  Â  Â  Â  Â  Â  3. <b>ê²€ì€ ê´‘ê³  ë¸”ë¡</b>ì€ ë‚œì´ë„ë¥¼ ë‚®ì¶°ì¤ë‹ˆë‹¤.<br>

Â  Â  Â  Â  Â  Â  Â  Â  4. í•˜ì–€ ì ë°•ì´ê°€ ë°”ë‹¥ ì„ ì— ë‹¿ìœ¼ë©´ íŒ¨ë°°!
Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="ad-modal" class="panel">
Â  Â  Â  Â  Â  Â  <h3 style="margin-top: 0; font-size: 18px;">ì ì‹œ íœ´ì‹!</h3>
Â  Â  Â  Â  Â  Â  <div id="ad-content" style="min-height: 60px; display: flex; align-items: center; justify-content: center; background: #eee; margin-bottom: 15px; border-radius: 8px; position: relative; overflow: hidden;">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="ad-loader">ê´‘ê³  ë¡œë”© ì¤‘...</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="kakao-ad-container"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button onclick="closeAd()">ê´‘ê³  ë‹«ê³  ê³„ì†í•˜ê¸°</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div id="game-over-panel" class="panel">
Â  Â  Â  Â  Â  Â  <h2 style="color: #ff4d4d;">GAME OVER</h2>
Â  Â  Â  Â  Â  Â  <div id="final-time-val" style="font-size: 28px; font-weight: bold; margin-bottom: 15px;">0.0s</div>
Â  Â  Â  Â  Â  Â  <button onclick="location.reload()">ë‹¤ì‹œ ë„ì „</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // 1. ì˜¤ë””ì˜¤ ì„¤ì •
Â  Â  Â  Â  const bgm = new Audio('Bgggm.mp3');Â 
Â  Â  Â  Â  bgm.loop = true;Â 
Â  Â  Â  Â  bgm.volume = 1.0;

Â  Â  Â  Â  let isMuted = localStorage.getItem('gameMuted') === 'true';
Â  Â  Â  Â  function syncMuteSettings() {
Â  Â  Â  Â  Â  Â  bgm.muted = isMuted;
Â  Â  Â  Â  Â  Â  const btn = document.getElementById('mute-btn');
Â  Â  Â  Â  Â  Â  if (btn) btn.innerText = isMuted ? "ğŸ”‡ Off" : "ğŸµ On";
Â  Â  Â  Â  }
Â  Â  Â  Â  syncMuteSettings();

Â  Â  Â  Â  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

Â  Â  Â  Â  function playSfx(type) {
Â  Â  Â  Â  Â  Â  if (isMuted || !gameActive) return;
Â  Â  Â  Â  Â  Â  const osc = audioCtx.createOscillator();
Â  Â  Â  Â  Â  Â  const gain = audioCtx.createGain();
Â  Â  Â  Â  Â  Â  osc.connect(gain); gain.connect(audioCtx.destination);
Â  Â  Â  Â  Â  Â  const now = audioCtx.currentTime;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (type === 'white') {
Â  Â  Â  Â  Â  Â  Â  Â  osc.type = 'sine'; osc.frequency.setValueAtTime(800, now);
Â  Â  Â  Â  Â  Â  Â  Â  gain.gain.setValueAtTime(0.1, now); gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
Â  Â  Â  Â  Â  Â  Â  Â  osc.start(); osc.stop(now + 0.1);
Â  Â  Â  Â  Â  Â  } else if (type === 'black') {
Â  Â  Â  Â  Â  Â  Â  Â  osc.type = 'square'; osc.frequency.setValueAtTime(400, now);
Â  Â  Â  Â  Â  Â  Â  Â  gain.gain.setValueAtTime(0.05, now); gain.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
Â  Â  Â  Â  Â  Â  Â  Â  osc.start(); osc.stop(now + 0.15);
Â  Â  Â  Â  Â  Â  } else if (type === 'fail') {
Â  Â  Â  Â  Â  Â  Â  Â  osc.type = 'sawtooth'; osc.frequency.setValueAtTime(200, now);
Â  Â  Â  Â  Â  Â  Â  Â  gain.gain.setValueAtTime(0.1, now); gain.gain.linearRampToValueAtTime(0, now + 0.5);
Â  Â  Â  Â  Â  Â  Â  Â  osc.start(); osc.stop(now + 0.5);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // 2. ê²Œì„ ë³€ìˆ˜
Â  Â  Â  Â  const canvas = document.getElementById('gameCanvas');
Â  Â  Â  Â  const ctx = canvas.getContext('2d');
Â  Â  Â  Â  canvas.width = 400; canvas.height = 650;
Â  Â  Â  Â  const groundY = canvas.height - 60;Â 

Â  Â  Â  Â  let blocks = [], particles = [];Â 
Â  Â  Â  Â  let isPaused = false, isGameOver = false, gameActive = false;
Â  Â  Â  Â  let moveSpeed = 2.3;Â 
Â  Â  Â  Â  let startTime = 0, pausedTimeTotal = 0, pauseStartedAt = 0;
Â  Â  Â  Â  let bestTime = localStorage.getItem('bestSurvivalTime') || 0;
Â  Â  Â  Â  document.getElementById('best-display').innerText = `Best: ${parseFloat(bestTime).toFixed(1)}s`;

Â  Â  Â  Â  // ë¸”ë¡/íŒŒí‹°í´ í´ë˜ìŠ¤ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
Â  Â  Â  Â  class Particle {
Â  Â  Â  Â  Â  Â  constructor(x, y, color) {
Â  Â  Â  Â  Â  Â  Â  Â  this.x = x; this.y = y; this.color = color;
Â  Â  Â  Â  Â  Â  Â  Â  this.size = Math.random() * 3 + 2;
Â  Â  Â  Â  Â  Â  Â  Â  this.speedX = (Math.random() - 0.5) * 6;
Â  Â  Â  Â  Â  Â  Â  Â  this.speedY = (Math.random() - 0.5) * 6 - 2;Â 
Â  Â  Â  Â  Â  Â  Â  Â  this.gravity = 0.15; this.life = 1.0;Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  update() { this.x += this.speedX; this.y += this.speedY; this.speedY += this.gravity; this.life -= 0.02; }
Â  Â  Â  Â  Â  Â  draw() { ctx.save(); ctx.globalAlpha = this.life; ctx.fillStyle = this.color; ctx.fillRect(this.x, this.y, this.size, this.size); ctx.restore(); }
Â  Â  Â  Â  }

Â  Â  Â  Â  class Block {
Â  Â  Â  Â  Â  Â  constructor(type, speed) {
Â  Â  Â  Â  Â  Â  Â  Â  this.width = 60; this.height = 50;
Â  Â  Â  Â  Â  Â  Â  Â  this.x = Math.random() * (canvas.width - this.width);
Â  Â  Â  Â  Â  Â  Â  Â  this.y = -60; this.type = type; this.speed = speed;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  draw() {
Â  Â  Â  Â  Â  Â  Â  Â  ctx.save();
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = (this.type === 'white' || this.type === 'whiteDot') ? '#FFFFFF' : '#000000';
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillRect(this.x, this.y, this.width, this.height);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.strokeStyle = '#333'; ctx.lineWidth = 2; ctx.strokeRect(this.x, this.y, this.width, this.height);
Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillStyle = (this.type === 'white' || this.type === 'whiteDot') ? '#333' : '#FFFFFF';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (this.type === 'whiteDot') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath(); ctx.arc(this.x + 30, this.y + 25, 4, 0, Math.PI*2); ctx.fill();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  [[15, 15], [45, 20], [20, 35], [40, 40]].forEach(p => {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.beginPath(); ctx.arc(this.x+p[0], this.y+p[1], 3, 0, Math.PI*2); ctx.fill();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  if(this.type === 'black') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.font = 'bold 14px sans-serif'; ctx.textAlign = 'center';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ctx.fillText("ê´‘ê³ ", this.x + 30, this.y + 32);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  ctx.restore();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  update() { if (!isPaused && !isGameOver && gameActive) this.y += this.speed; }
Â  Â  Â  Â  }

Â  Â  Â  Â  // 3. ê²Œì„ ì—”ì§„ í•¨ìˆ˜
Â  Â  Â  Â  function spawnBlock() {
Â  Â  Â  Â  Â  Â  if (!isPaused && !isGameOver && gameActive) {
Â  Â  Â  Â  Â  Â  Â  Â  let elapsed = (Date.now() - startTime - pausedTimeTotal) / 1000;
Â  Â  Â  Â  Â  Â  Â  Â  let rand = Math.random();
Â  Â  Â  Â  Â  Â  Â  Â  let newType = 'white';
Â  Â  Â  Â  Â  Â  Â  Â  if (elapsed > 20 && rand < 0.2) newType = 'whiteDot';
Â  Â  Â  Â  Â  Â  Â  Â  else if (rand > 0.82) newType = 'black'; // í™•ë¥  ì‚´ì§ ì¡°ì •
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  blocks.push(new Block(newType, moveSpeed));
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  let nextSpawn = Math.max(160, 680 - (moveSpeed * 95));Â 
Â  Â  Â  Â  Â  Â  setTimeout(spawnBlock, nextSpawn);
Â  Â  Â  Â  }

Â  Â  Â  Â  setInterval(() => { if (!isPaused && !isGameOver && gameActive) moveSpeed += 0.1; }, 1000);

Â  Â  Â  Â  function update() {
Â  Â  Â  Â  Â  Â  if (isGameOver || !gameActive) return;
Â  Â  Â  Â  Â  Â  ctx.clearRect(0, 0, canvas.width, canvas.height);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (!isPaused) {
Â  Â  Â  Â  Â  Â  Â  Â  let elapsed = (Date.now() - startTime - pausedTimeTotal) / 1000;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('time-display').innerText = `${elapsed.toFixed(1)}s`;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // ë°ë“œë¼ì¸ (ë¹¨ê°„ì„ )
Â  Â  Â  Â  Â  Â  ctx.beginPath(); ctx.moveTo(0, groundY); ctx.lineTo(canvas.width, groundY);
Â  Â  Â  Â  Â  Â  ctx.strokeStyle = '#ff4d4d'; ctx.lineWidth = 4; ctx.stroke();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  particles.forEach((p, i) => { p.update(); p.draw(); if(p.life <=0) particles.splice(i,1); });

Â  Â  Â  Â  Â  Â  for (let i = blocks.length - 1; i >= 0; i--) {
Â  Â  Â  Â  Â  Â  Â  Â  const b = blocks[i];
Â  Â  Â  Â  Â  Â  Â  Â  b.update(); b.draw();

Â  Â  Â  Â  Â  Â  Â  Â  if (b.type === 'white' && b.y + b.height >= groundY) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  gameOver();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  if (b.y > canvas.height) blocks.splice(i, 1);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  requestAnimationFrame(update);
Â  Â  Â  Â  }

Â  Â  Â  Â  function gameOver() {
Â  Â  Â  Â  Â  Â  isGameOver = true;Â 
Â  Â  Â  Â  Â  Â  playSfx('fail');Â 
Â  Â  Â  Â  Â  Â  bgm.pause();
Â  Â  Â  Â  Â  Â  let finalTime = (Date.now() - startTime - pausedTimeTotal) / 1000;
Â  Â  Â  Â  Â  Â  document.getElementById('final-time-val').innerText = `${finalTime.toFixed(1)}s`;
Â  Â  Â  Â  Â  Â  if (finalTime > parseFloat(bestTime)) localStorage.setItem('bestSurvivalTime', finalTime);
Â  Â  Â  Â  Â  Â  document.getElementById('game-over-panel').style.display = 'block';
Â  Â  Â  Â  }

Â  Â  Â  Â  function handleInput(e) {
Â  Â  Â  Â  Â  Â  if (!gameActive || isPaused || isGameOver) return;
Â  Â  Â  Â  Â  Â  const rect = canvas.getBoundingClientRect();
Â  Â  Â  Â  Â  Â  const scaleX = canvas.width / rect.width;
Â  Â  Â  Â  Â  Â  const scaleY = canvas.height / rect.height;
Â  Â  Â  Â  Â  Â  const clientX = (e.touches ? e.touches[0].clientX : e.clientX);
Â  Â  Â  Â  Â  Â  const clientY = (e.touches ? e.touches[0].clientY : e.clientY);
Â  Â  Â  Â  Â  Â  const mouseX = (clientX - rect.left) * scaleX;
Â  Â  Â  Â  Â  Â  const mouseY = (clientY - rect.top) * scaleY;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // í„°ì¹˜ íŒì • ë²”ìœ„ ë„‰ë„‰í•˜ê²Œ ìˆ˜ì •
Â  Â  Â  Â  Â  Â  const hitPadding = 20;

Â  Â  Â  Â  Â  Â  for (let i = blocks.length - 1; i >= 0; i--) {
Â  Â  Â  Â  Â  Â  Â  Â  const b = blocks[i];
Â  Â  Â  Â  Â  Â  Â  Â  if (mouseX >= b.x - hitPadding && mouseX <= b.x + b.width + hitPadding &&
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mouseY >= b.y - hitPadding && mouseY <= b.y + b.height + hitPadding) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (b.type === 'white') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  playSfx('white');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for (let j = 0; j < 12; j++) particles.push(new Particle(b.x+30, b.y+25, '#CCCCCC'));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  blocks.splice(i, 1);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showAd();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const pColor = b.type === 'black' ? '#333333' : '#CCCCCC';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for (let j = 0; j < 12; j++) particles.push(new Particle(b.x+30, b.y+25, pColor));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  blocks.splice(i, 1);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break;Â 
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  canvas.addEventListener('touchstart', (e) => { e.preventDefault(); handleInput(e); }, {passive: false});
Â  Â  Â  Â  canvas.addEventListener('mousedown', handleInput);

Â  Â  Â  Â  // 4. ê´‘ê³  ë° ì œì–´ ë¡œì§ ë³´ì™„
Â  Â  Â  Â  function showAd() {
Â  Â  Â  Â  Â  Â  isPaused = true;Â 
Â  Â  Â  Â  Â  Â  bgm.pause();Â 
Â  Â  Â  Â  Â  Â  pauseStartedAt = Date.now();
Â  Â  Â  Â  Â  Â  document.getElementById('ad-modal').style.display = 'block';

Â  Â  Â  Â  Â  Â  // [ë³´ì™„] ê´‘ê³  ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™” ë° ì¬ìƒì„± (ê´‘ê³  ê°±ì‹ ìš©)
Â  Â  Â  Â  Â  Â  const container = document.getElementById('kakao-ad-container');
Â  Â  Â  Â  Â  Â  container.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <ins class="kakao_ad_area" style="display:none;"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data-ad-unit = "DAN-tTvpwiRyg3nxCPs1"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data-ad-width = "320"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  data-ad-height = "50"></ins>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  // ì¹´ì¹´ì˜¤ ê´‘ê³  ìŠ¤í¬ë¦½íŠ¸ ì¬í˜¸ì¶œ
Â  Â  Â  Â  Â  Â  const script = document.createElement('script');
Â  Â  Â  Â  Â  Â  script.src = "//t1.daumcdn.net/kas/static/ba.min.js";
Â  Â  Â  Â  Â  Â  script.async = true;
Â  Â  Â  Â  Â  Â  container.appendChild(script);
Â  Â  Â  Â  }

Â  Â  Â  Â  function closeAd() {
Â  Â  Â  Â  Â  Â  moveSpeed = Math.max(1.8, moveSpeed - 0.4); // ì†ë„ë¥¼ ë” ì‹œì›í•˜ê²Œ ì¤„ì„
Â  Â  Â  Â  Â  Â  pausedTimeTotal += (Date.now() - pauseStartedAt);
Â  Â  Â  Â  Â  Â  isPaused = false;Â 
Â  Â  Â  Â  Â  Â  if (!isMuted) bgm.play().catch(() => {});
Â  Â  Â  Â  Â  Â  document.getElementById('ad-modal').style.display = 'none';
Â  Â  Â  Â  }

Â  Â  Â  Â  function startGame() {
Â  Â  Â  Â  Â  Â  document.getElementById('start-overlay').style.display = 'none';
Â  Â  Â  Â  Â  Â  gameActive = true;
Â  Â  Â  Â  Â  Â  if (audioCtx.state === 'suspended') audioCtx.resume();
Â  Â  Â  Â  Â  Â  bgm.muted = isMuted;
Â  Â  Â  Â  Â  Â  if (!isMuted) bgm.play().catch(e => console.log("Audio fail:", e));
Â  Â  Â  Â  Â  Â  startTime = Date.now();
Â  Â  Â  Â  Â  Â  spawnBlock();
Â  Â  Â  Â  Â  Â  update();
Â  Â  Â  Â  }

Â  Â  Â  Â  function toggleMute(e) {
Â  Â  Â  Â  Â  Â  if(e) e.stopPropagation();
Â  Â  Â  Â  Â  Â  isMuted = !isMuted;
Â  Â  Â  Â  Â  Â  localStorage.setItem('gameMuted', isMuted);
Â  Â  Â  Â  Â  Â  bgm.muted = isMuted;
Â  Â  Â  Â  Â  Â  if (isMuted) bgm.pause();
Â  Â  Â  Â  Â  Â  else if (gameActive && !isPaused) bgm.play().catch(() => {});
Â  Â  Â  Â  Â  Â  document.getElementById('mute-btn').innerText = isMuted ? "ğŸ”‡ Off" : "ğŸµ On";
Â  Â  Â  Â  }

Â  Â  Â  Â  window.onload = syncMuteSettings;
Â  Â  </script>
</body>
</html>
